<html>
    <head>
        <title>Logged Values Charts</title>
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                text-align: center;
            }
            .chart-container {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
                width: 100%;
                max-width: 1200px;
                margin: 0 auto;
            }
            canvas {
                width: 100% !important;
                height: 250px !important;
            }
            h1 {
                font-size: 24px;
                margin-bottom: 20px;
            }
            h2 {
                font-size: 20px;
                margin-bottom: 10px;
            }
        </style>
    </head>
    <body>
        <h1>Logged Values in Last 24 Hours</h1>

        <div class="chart-container">
            <div>
                <h2>PM02</h2>
                <canvas id="pm02Chart"></canvas>
            </div>
            <div>
                <h2>RCO2</h2>
                <canvas id="rco2Chart"></canvas>
            </div>
            <div>
                <h2>ATMP</h2>
                <canvas id="atmpChart"></canvas>
            </div>
            <div>
                <h2>RHUM</h2>
                <canvas id="rhumChart"></canvas>
            </div>
        </div>

        <script>
            fetch('/data')
            .then(response => response.json())
            .then(data => {
                function getLineColor(value) {
                    return value > 100 ? 'rgb(255, 99, 132)' : 'rgb(75, 192, 192)';
                }

                const pm02Ctx = document.getElementById('pm02Chart').getContext('2d');
                const rco2Ctx = document.getElementById('rco2Chart').getContext('2d');
                const atmpCtx = document.getElementById('atmpChart').getContext('2d');
                const rhumCtx = document.getElementById('rhumChart').getContext('2d');

                function createChart(ctx, data, label) {
                    new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: data.timestamps,
                            datasets: [{
                                label: label,
                                data: data[label.toLowerCase()],
                                borderColor: 'rgb(75, 192, 192)',
                                fill: false,
                            }]
                        },
                        options: {
                            responsive: true,
                            scales: {
                                x: {
                                    ticks: {
                                        maxRotation: 90,
                                        minRotation: 45
                                    }
                                }
                            }
                        }
                    });
                }

                createChart(pm02Ctx, data, 'PM02');
                createChart(rco2Ctx, data, 'RCO2');
                createChart(atmpCtx, data, 'ATMP');
                createChart(rhumCtx, data, 'RHUM');
            });
        </script>
    </body>
</html>
